# Introduction
This GitHub repository (forked from https://github.com/hzc363/DeepLearningCyTOF) contains a tutorial for creating deep learning models tailored to CyTOF data. We will apply the model to diagnose latent cytomegalovirus (CMV) infection. We will also use a decision tree-based method to identify cell subsets that are associated with the CMV infection. 

## Pull the Singularity Container and Execute the Jupyter Notebook on Locus (HPC)
**Pull the latest Singularity container in your working directory from the link below.**  

[https://cloud.sylabs.io/library/rohitfarmer/default/cytof-deep-cnn](https://cloud.sylabs.io/library/rohitfarmer/default/cytof-deep-cnn)

**Execute jupyter notebook via Singularity container on the HPC.**  

1. SSH to the HPC.
1. Claim an interactive node.
1. Navigate to your project directory. Singularity container should be in your project directory.
1. `singularity exec container-name.sif jupyter notebook --no-browser --ip='0.0.0.0'`
1. Copy the link generated by the jupyter daemon and paste it on your web browser.
1. Open `DeepLearning_CyTOF.ipynb` notebook.
1. Keep the SSH session and Jupyter notebook session running. Copy the URL on your local browser.

## For Conda Users: Create a Conda Environment
Navigate into the tutorial folder. Create a conda environment with dependencies for the tutorial. Install time takes around 5 mins.  

```conda create --name CyTOF_DL --file requirements.txt```

### Main tutorial
Activate the conda environment.

```conda activate CyTOF_DL```

Run the main tutorial [DeepLearning_CyTOF.ipynb](https://github.com/hzc363/DeepLearningCyTOF/blob/master/DeepLearning_CyTOF.ipynb). It takes around 40 mins to run in a laptop with 2.5 GHz GPU (Intel Core i7) and 16 GB Memory. 

```jupyter notebook DeepLearning_CyTOF.ipynb```


# CyTOF data processing
Please see the script in [FCS_to_Array folder](https://github.com/rohitfarmer/DeepLearningCyTOF/tree/master/FCS_to_Array) for detailed preprocessing steps of the CyTOF data. 

# More Information
For more background information on deep learning and its use in cytometry data, see the [slides](https://github.com/rohitfarmer/DeepLearningCyTOF/blob/master/FOCIS_deeplearning.pdf) of the FOCIS 2019 workshop. 

